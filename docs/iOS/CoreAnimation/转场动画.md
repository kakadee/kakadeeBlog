# iOS 转场动画

## 什么是转场动画

转场动画是将一个视图控制器的内容替换为另一个视图控制器的内容。转场动画有两种类型：
presentations (展示）
dismissals (消失）

实现一个转场动画需要操作很多对象。UIKit 其实已经为我们控制器的转换提供了默认的转场动画，当然，你也可以使用自定义的转场动画。

## Transitioning Delegate

UIViewControllerTransitioningDelegate 代理操作以下几个对象：
Animator objects
动画对象

Interactive animator objects
手势交互动画对象
最简单的创建手势交互动画的方法就是使用 UIPercentDrivenInteractiveTransition

Presentation controller
该控制器只有在视图控制器的modalPresentationStyle 设置成 UIModalPresentationCustom 才会使用。

当一个 presented view controller 的 transitioningDelegate 不为空的时候， UIKit 会使用你提供的自定义动画去展示控制器.
当要准备展示的时候，UIKit 会调用 `animationControllerForPresentedController:presentingController:sourceController:` 方法，去检索自定义的动画对象。如果所有的对象都准备好了，UIKit会执行以下动作：

1. UIKit 调用 `interactionControllerForPresentation:` 代理方法去查看是否手势动画对象是存在的，如果是nil,UIKit执行不包含手势交互的动画。

2. UIKit 调用 动画对象的`transitionDuration:` 方法来获取动画执行时间。

3. UIKit 选择合适的方法去开始执行动画：

    * 对没有手势交互的动画，UIKit 调用 `animateTransition:` 方法。
    * 对于手势交互动画，UIKit 调用 `startInteractiveTransition:` 方法。

4. UIKit 等待动画对象执行完，调用 `completeTransition:` 方法。
当动画对象执行完，UIKit就知道应该调用 `presentViewController:animated:completion:` 里的 completion 了。 接着，会调用 动画对象自己的 `animationEnded:` 方法。

> Calling the completeTransition: method at the end of your animations is required. UIKit does not end the transition process, and thereby return control to your app, until you call that method.


![pic1](https://raw.githubusercontent.com/kakadee/myMarkDownPic/master/img/20190814150042.png)




## 参考

1. Customizing the Transition Animations
<!-- <https://developer.apple.com/library/archive/featuredarticles/ViewControllerPGforiPhoneOS/CustomizingtheTransitionAnimations.html#//apple_ref/doc/uid/TP40007457-CH16-SW1> -->
